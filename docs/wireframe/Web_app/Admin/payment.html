<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECONTACT Admin - Quản lý Học phí</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        :root {
            --primary: #0284C7;
            --sidebar-width: 280px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        .sidebar {
            width: var(--sidebar-width);
            transition: all 0.3s ease;
        }

        .nav-item {
            transition: all 0.2s ease;
        }

        .nav-item.active {
            background-color: rgba(2, 132, 199, 0.1);
            color: var(--primary);
            border-right: 4px solid var(--primary);
        }

        .card-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Step Wizard Styles */
        .step-item {
            position: relative;
            transition: all 0.3s ease;
        }

        .step-item::after {
            content: '';
            position: absolute;
            top: 24px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: #e2e8f0;
            z-index: 0;
        }

        .step-item:last-child::after {
            display: none;
        }

        .step-item.active .step-circle {
            background: linear-gradient(135deg, #0284C7 0%, #0369a1 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(2, 132, 199, 0.3);
        }

        .step-item.completed .step-circle {
            background: #22c55e;
            color: white;
        }

        .step-circle {
            width: 48px;
            height: 48px;
            border-radius: 16px;
            background: white;
            border: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 18px;
            z-index: 10;
            position: relative;
            transition: all 0.3s ease;
        }

        /* Checkbox Custom */
        .custom-checkbox {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .custom-checkbox:checked {
            background: #0284C7;
            border-color: #0284C7;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Multi-select Tags */
        .multi-select-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #0369a1;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
            margin: 4px;
        }

        .multi-select-tag button {
            background: none;
            border: none;
            color: #0369a1;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }

        /* Modal Styles */
        .modal-overlay {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px);
        }
    </style>
</head>

<body class="flex">

    <!-- SIDEBAR NAVIGATION -->
    <aside class="sidebar h-screen bg-white border-r border-slate-200 flex flex-col sticky top-0 shrink-0">
        <!-- Brand -->
        <div class="p-6 border-b border-slate-100 flex items-center gap-3">
            <div class="p-2 bg-blue-50 rounded-xl">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#0284C7" stroke-width="2.5">
                    <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M2 17L12 22L22 17" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </div>
            <div>
                <h1 class="text-xl font-black text-slate-800 tracking-tight leading-none">ECONTACT</h1>
                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Admin Portal</span>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 overflow-y-auto py-6 px-3 space-y-1">
            <p class="px-4 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">Chính</p>

            <a href="dashboard.html"
                class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-50">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7" />
                    <rect x="14" y="3" width="7" height="7" />
                    <rect x="14" y="14" width="7" height="7" />
                    <rect x="3" y="14" width="7" height="7" />
                </svg>
                Tổng quan
            </a>

            <p class="px-4 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 mt-6">Quản trị</p>

            <a href="#"
                class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-50">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
                Người dùng
            </a>

            <a href="#"
                class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-50">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M22 10v6M2 10l10-5 10 5-10 5z" />
                    <path d="M6 12v5c3 3 9 3 12 0v-5" />
                </svg>
                Học thuật (Lớp/Môn)
            </a>

            <p class="px-4 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 mt-6">Vận hành</p>

            <a href="#"
                class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-50">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <line x1="16" y1="2" x2="16" y2="6" />
                    <line x1="8" y1="2" x2="8" y2="6" />
                    <line x1="3" y1="10" x2="21" y2="10" />
                </svg>
                Điểm danh
            </a>

            <a href="#"
                class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-50">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 1 1-7.6-10.6" />
                    <polyline points="22 4 12 14.01 9 11.01" />
                </svg>
                Quản lý Điểm số
            </a>

            <a href="payment.html"
                class="nav-item active flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <rect x="2" y="5" width="20" height="14" rx="2" />
                    <line x1="2" y1="10" x2="22" y2="10" />
                </svg>
                Học phí & Tài chính
            </a>

            <a href="#"
                class="nav-item flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm text-slate-600 hover:bg-slate-50">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" />
                    <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                </svg>
                Thông báo
            </a>
        </nav>

        <!-- User Profile Sidebar Bottom -->
        <div class="p-4 border-t border-slate-100 bg-slate-50/50">
            <div class="flex items-center gap-3 p-2">
                <div class="w-10 h-10 rounded-full bg-slate-200 border-2 border-white overflow-hidden">
                    <img src="https://ui-avatars.com/api/?name=Admin+Hust&background=0284C7&color=fff" alt="Avatar">
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-xs font-bold text-slate-800 truncate">Admin123</p>
                    <p class="text-[10px] text-slate-400 font-medium truncate">ad001@econtact.vn</p>
                </div>
                <button class="text-slate-400 hover:text-red-500">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                        <polyline points="16 17 21 12 16 7" />
                        <line x1="21" y1="12" x2="9" y2="12" />
                    </svg>
                </button>
            </div>
        </div>
    </aside>

    <!-- MAIN CONTENT AREA -->
    <main class="flex-1 min-w-0 h-screen overflow-y-auto bg-slate-50">

        <!-- TOP HEADER -->
        <header class="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 sticky top-0 z-40">
            <div class="flex items-center gap-4">
                <h2 class="text-lg font-extrabold text-slate-800">Quản lý Học phí</h2>

                <!-- School Year Badge -->
                <div class="hidden md:flex items-center gap-2 bg-blue-50 px-4 py-2 rounded-full">
                    <span class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></span>
                    <span class="text-xs font-black text-[#0284C7] uppercase tracking-wider">2025-2026</span>
                </div>
            </div>

            <div class="flex items-center gap-3">
                <button class="p-2 text-slate-500 hover:bg-slate-100 rounded-lg relative">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" />
                        <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                    </svg>
                    <span class="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border-2 border-white"></span>
                </button>
                <button class="p-2 text-slate-500 hover:bg-slate-100 rounded-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- CONTENT BODY -->
        <div class="p-8 space-y-8">

            <!-- PHÂN KHU 1: QUẢN LÝ DANH MỤC KHOẢN THU (FEE ITEM LIBRARY) -->
            <section class="bg-white rounded-[32px] card-shadow border border-slate-100 overflow-hidden">
                <!-- Section Header -->
                <div class="p-8 border-b border-slate-100 flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="#0284C7" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                <polyline points="14 2 14 8 20 8" />
                                <line x1="16" y1="13" x2="8" y2="13" />
                                <line x1="16" y1="17" x2="8" y2="17" />
                                <polyline points="10 9 9 9 8 9" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-xl font-black text-slate-800 tracking-tight">Quản lý Danh mục Khoản thu</h3>
                            <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest mt-1">Fee Item
                                Library - Cấu hình các loại tiền học phí</p>
                        </div>
                    </div>
                    <button onclick="openAddFeeModal()"
                        class="px-5 py-2.5 bg-[#0284C7] text-white rounded-xl font-bold text-sm hover:bg-[#0369a1] flex items-center gap-2 shadow-lg shadow-blue-100 transition-all">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="3">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        Thêm khoản thu mới
                    </button>
                </div>

                <!-- Filters -->
                <div class="px-8 pt-6 pb-4 flex items-center gap-4 flex-wrap">
                    <div class="flex items-center gap-2">
                        <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Năm học:</span>
                        <select id="filterYear" onchange="filterFeeItems()"
                            class="bg-slate-50 border border-slate-200 text-xs font-bold rounded-xl px-4 py-2 outline-none cursor-pointer hover:border-blue-200 transition-all">
                            <option value="2025-2026">2025-2026</option>
                            <option value="2024-2025">2024-2025</option>
                            <option value="2023-2024">2023-2024</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Học kỳ:</span>
                        <select id="filterSemester" onchange="filterFeeItems()"
                            class="bg-slate-50 border border-slate-200 text-xs font-bold rounded-xl px-4 py-2 outline-none cursor-pointer hover:border-blue-200 transition-all">
                            <option value="all">Tất cả</option>
                            <option value="1">Học kỳ 1</option>
                            <option value="2">Học kỳ 2</option>
                        </select>
                    </div>
                </div>

                <!-- Fee Items Table -->
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="bg-slate-50">
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest w-64">
                                    Tên khoản thu</th>
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest w-32">
                                    Mã khoản thu</th>
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest w-28">
                                    Loại</th>
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                    Số tiền (VNĐ)</th>
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                    Học kỳ</th>
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                    Trạng thái</th>
                                <th class="px-8 py-4 text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                    Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="feeItemsTableBody" class="divide-y divide-slate-100">
                            <!-- Sample Data -->
                            <tr class="hover:bg-slate-50/50 transition-all">
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#0284C7"
                                                stroke-width="2">
                                                <path d="M22 10v6M2 10l10-5 10 5-10 5z" />
                                                <path d="M6 12v5c3 3 9 3 12 0v-5" />
                                            </svg>
                                        </div>
                                        <span class="text-sm font-bold text-slate-800">Học phí</span>
                                    </div>
                                </td>
                                <td class="px-8 py-4">
                                    <span class="text-xs font-bold text-slate-500 bg-slate-100 px-2 py-1 rounded-lg font-mono">HP-HK1</span>
                                </td>
                                <td class="px-8 py-4">
                                    <span
                                        class="px-3 py-1 bg-red-100 text-red-600 text-[10px] font-black uppercase rounded-lg">Bắt
                                        buộc</span>
                                </td>
                                <td class="px-8 py-4 text-sm font-bold text-slate-700">2,500,000 ₫</td>
                                <td class="px-8 py-4 text-sm font-medium text-slate-500">Học kỳ 1</td>
                                <td class="px-8 py-4">
                                    <span class="flex items-center gap-2 text-sm font-medium text-green-600">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        Hoạt động
                                    </span>
                                </td>
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-2">
                                        <button class="p-2 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                            </svg>
                                        </button>
                                        <button onclick="deleteFeeItem(this)" class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <polyline points="3 6 5 6 21 6" />
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="hover:bg-slate-50/50 transition-all">
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-xl bg-teal-100 flex items-center justify-center">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#0d9488"
                                                stroke-width="2">
                                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                            </svg>
                                        </div>
                                        <span class="text-sm font-bold text-slate-800">Bảo hiểm y tế</span>
                                    </div>
                                </td>
                                <td class="px-8 py-4">
                                    <span class="text-xs font-bold text-slate-500 bg-slate-100 px-2 py-1 rounded-lg font-mono">BHYT-25</span>
                                </td>
                                <td class="px-8 py-4">
                                    <span
                                        class="px-3 py-1 bg-red-100 text-red-600 text-[10px] font-black uppercase rounded-lg">Bắt
                                        buộc</span>
                                </td>
                                <td class="px-8 py-4 text-sm font-bold text-slate-700">854,000 ₫</td>
                                <td class="px-8 py-4 text-sm font-medium text-slate-500">Cả năm</td>
                                <td class="px-8 py-4">
                                    <span class="flex items-center gap-2 text-sm font-medium text-green-600">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        Hoạt động
                                    </span>
                                </td>
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-2">
                                        <button class="p-2 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                            </svg>
                                        </button>
                                        <button onclick="deleteFeeItem(this)" class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <polyline points="3 6 5 6 21 6" />
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="hover:bg-slate-50/50 transition-all">
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#9333ea"
                                                stroke-width="2">
                                                <path d="M20.38 3.4a1.6 1.6 0 0 0-2.22 0l-1.62 1.62a1.6 1.6 0 0 0 0 2.22l2.94 2.94a1.6 1.6 0 0 0 2.22 0l1.62-1.62a1.6 1.6 0 0 0 0-2.22z" />
                                                <path d="M4.5 13.5l-2.12 2.12a1.6 1.6 0 0 0 0 2.22l2.94 2.94a1.6 1.6 0 0 0 2.22 0L9.66 18.5" />
                                                <path d="M4.5 13.5l9.38-9.38a1.6 1.6 0 0 1 2.22 0l2.94 2.94a1.6 1.6 0 0 1 0 2.22L9.66 18.66" />
                                            </svg>
                                        </div>
                                        <span class="text-sm font-bold text-slate-800">Tiền đồng phục</span>
                                    </div>
                                </td>
                                <td class="px-8 py-4">
                                    <span class="text-xs font-bold text-slate-500 bg-slate-100 px-2 py-1 rounded-lg font-mono">DP-HK1</span>
                                </td>
                                <td class="px-8 py-4">
                                    <span
                                        class="px-3 py-1 bg-blue-100 text-blue-600 text-[10px] font-black uppercase rounded-lg">Tự
                                        nguyện</span>
                                </td>
                                <td class="px-8 py-4 text-sm font-bold text-slate-700">850,000 ₫</td>
                                <td class="px-8 py-4 text-sm font-medium text-slate-500">Học kỳ 1</td>
                                <td class="px-8 py-4">
                                    <span class="flex items-center gap-2 text-sm font-medium text-green-600">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        Hoạt động
                                    </span>
                                </td>
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-2">
                                        <button class="p-2 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                            </svg>
                                        </button>
                                        <button onclick="deleteFeeItem(this)" class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <polyline points="3 6 5 6 21 6" />
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="hover:bg-slate-50/50 transition-all">
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-xl bg-orange-100 flex items-center justify-center">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ea580c"
                                                stroke-width="2">
                                                <path d="M12 21a9 9 0 0 0 9-9c0-4.97-4.03-9-9-9a9 9 0 0 0-9 9c0 4.97 4.03 9 9 9Z" />
                                                <path d="M12 7v5l3 3" />
                                            </svg>
                                        </div>
                                        <span class="text-sm font-bold text-slate-800">Tiền ăn bán trú</span>
                                    </div>
                                </td>
                                <td class="px-8 py-4">
                                    <span class="text-xs font-bold text-slate-500 bg-slate-100 px-2 py-1 rounded-lg font-mono">BT-HK1</span>
                                </td>
                                <td class="px-8 py-4">
                                    <span
                                        class="px-3 py-1 bg-blue-100 text-blue-600 text-[10px] font-black uppercase rounded-lg">Tự
                                        nguyện</span>
                                </td>
                                <td class="px-8 py-4 text-sm font-bold text-slate-700">1,200,000 ₫</td>
                                <td class="px-8 py-4 text-sm font-medium text-slate-500">Học kỳ 1</td>
                                <td class="px-8 py-4">
                                    <span class="flex items-center gap-2 text-sm font-medium text-green-600">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        Hoạt động
                                    </span>
                                </td>
                                <td class="px-8 py-4">
                                    <div class="flex items-center gap-2">
                                        <button class="p-2 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                            </svg>
                                        </button>
                                        <button onclick="deleteFeeItem(this)" class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2">
                                                <polyline points="3 6 5 6 21 6" />
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- PHÂN KHU 2: QUẢN LÝ HÓA ĐƠN & THEO DÕI CÔNG NỢ - QUICK ACCESS -->
            <section class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-[32px] card-shadow border border-purple-100 overflow-hidden">
                <div class="p-12 flex items-center justify-between">
                    <div class="flex items-center gap-6">
                        <div class="p-5 bg-white rounded-3xl shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"
                                fill="none" stroke="#9333ea" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                <polyline points="14 2 14 8 20 8" />
                                <line x1="16" y1="13" x2="8" y2="13" />
                                <line x1="16" y1="17" x2="8" y2="17" />
                                <polyline points="10 9 9 9 8 9" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-2xl font-black text-slate-800 tracking-tight">Quản lý Hóa đơn & Theo dõi Công nợ</h3>
                            <p class="text-slate-500 text-sm font-bold mt-2">Xem công nợ, xác nhận thanh toán, gửi nhắc nhở</p>
                            <div class="flex items-center gap-4 mt-4">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                                    <span class="text-sm font-bold text-slate-600">24 hóa đơn</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 bg-amber-500 rounded-full"></div>
                                    <span class="text-sm font-bold text-slate-600">8 chờ đóng</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                    <span class="text-sm font-bold text-slate-600">16 đã hoàn thành</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a href="invoice-tracker.html"
                        class="px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl font-bold text-base hover:from-purple-600 hover:to-pink-600 flex items-center gap-3 shadow-xl shadow-purple-200 transition-all transform hover:scale-105">
                        <span>Mở Quản lý Hóa đơn</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>
                </div>
            </section>

            <!-- PHÂN KHU 3: THIẾT LẬP ĐỢT THU VÀ ÁP DỤNG (FEE ASSIGNMENT) -->
            <section class="bg-white rounded-[32px] card-shadow border border-slate-100 overflow-hidden">
                <!-- Section Header -->
                <div class="p-8 border-b border-slate-100">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="p-3 bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="#22c55e" stroke-width="2">
                                <rect x="2" y="5" width="20" height="14" rx="2" />
                                <line x1="2" y1="10" x2="22" y2="10" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-xl font-black text-slate-800 tracking-tight">Thiết lập Đợt thu và Áp dụng</h3>
                            <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest mt-1">Fee Assignment
                                - Tạo phiếu thu hàng loạt</p>
                        </div>
                    </div>

                    <!-- Step Wizard -->
                    <div class="flex items-center justify-between">
                        <div class="step-item active flex-1" id="step1">
                            <div class="flex flex-col items-center">
                                <div class="step-circle">1</div>
                                <span class="text-[10px] font-black text-slate-800 uppercase tracking-widest mt-2">Chọn
                                    đối tượng</span>
                            </div>
                        </div>
                        <div class="step-item flex-1" id="step2">
                            <div class="flex flex-col items-center">
                                <div class="step-circle">2</div>
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest mt-2">Chọn
                                    khoản thu</span>
                            </div>
                        </div>
                        <div class="step-item flex-1" id="step3">
                            <div class="flex flex-col items-center">
                                <div class="step-circle">3</div>
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest mt-2">Cấu
                                    hình thời gian</span>
                            </div>
                        </div>
                        <div class="step-item flex-1" id="step4">
                            <div class="flex flex-col items-center">
                                <div class="step-circle">4</div>
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest mt-2">Xác
                                    nhận & Phê duyệt</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step Content -->
                <div class="p-8">

                    <!-- STEP 1: Chọn đối tượng -->
                    <div id="stepContent1" class="step-content animate-slide-in">
                        <div class="mb-6">
                            <h4 class="text-base font-black text-slate-800 mb-2">Bước 1: Chọn Khối/Lớp áp dụng</h4>
                            <p class="text-sm text-slate-500">Chọn các khối hoặc lớp học cụ thể để áp dụng biểu phí</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Grade Selection -->
                            <div>
                                <h5 class="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                                    </svg>
                                    Chọn theo Khối
                                </h5>
                                <div class="space-y-2">
                                    <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl cursor-pointer hover:bg-slate-100 transition-all">
                                        <input type="checkbox" class="custom-checkbox" onchange="toggleGrade('6')">
                                        <span class="text-sm font-bold text-slate-700">Khối 6</span>
                                        <span class="text-xs text-slate-400 ml-auto">6 lớp • 180 học sinh</span>
                                    </label>
                                    <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl cursor-pointer hover:bg-slate-100 transition-all">
                                        <input type="checkbox" class="custom-checkbox" onchange="toggleGrade('7')">
                                        <span class="text-sm font-bold text-slate-700">Khối 7</span>
                                        <span class="text-xs text-slate-400 ml-auto">6 lớp • 195 học sinh</span>
                                    </label>
                                    <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl cursor-pointer hover:bg-slate-100 transition-all">
                                        <input type="checkbox" class="custom-checkbox" onchange="toggleGrade('8')">
                                        <span class="text-sm font-bold text-slate-700">Khối 8</span>
                                        <span class="text-xs text-slate-400 ml-auto">6 lớp • 188 học sinh</span>
                                    </label>
                                    <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl cursor-pointer hover:bg-slate-100 transition-all">
                                        <input type="checkbox" class="custom-checkbox" onchange="toggleGrade('9')">
                                        <span class="text-sm font-bold text-slate-700">Khối 9</span>
                                        <span class="text-xs text-slate-400 ml-auto">6 lớp • 175 học sinh</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Selected Classes Display -->
                            <div>
                                <h5 class="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                        <circle cx="9" cy="7" r="4" />
                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                    </svg>
                                    Lớp đã chọn
                                </h5>
                                <div id="selectedClassesDisplay" class="min-h-[200px] p-4 bg-slate-50 rounded-xl border-2 border-dashed border-slate-200">
                                    <p class="text-sm text-slate-400 text-center py-8">Chưa chọn lớp nào</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 2: Đặt tên & Chọn khoản thu -->
                    <div id="stepContent2" class="step-content hidden">
                        <div class="mb-6">
                            <h4 class="text-base font-black text-slate-800 mb-2">Bước 2: Đặt tên & Chọn khoản thu</h4>
                            <p class="text-sm text-slate-500">Đặt tên cho đợt thu và chọn các khoản thu cần áp dụng</p>
                        </div>

                        <!-- Invoice Name Input -->
                        <div class="mb-6">
                            <label class="text-sm font-bold text-slate-700 mb-2 flex items-center gap-2">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="11 4 11 8 15 8"></polyline>
                                </svg>
                                Tên phiếu thu
                            </label>
                            <input type="text" id="invoiceName" placeholder="Ví dụ: Học phí HK1 - 2025, Tiền ăn tháng 10..."
                                class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-100 outline-none focus:border-blue-300"
                                oninput="updateInvoiceName()">
                            <p class="text-[10px] text-slate-400 mt-1">Tên phiếu thu sẽ hiển thị cho phụ huynh và trong danh sách hóa đơn</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="feeItemsGrid">
                            <!-- Fee Item Cards -->
                            <label class="flex items-start gap-4 p-5 bg-slate-50 rounded-2xl cursor-pointer hover:bg-blue-50 transition-all border-2 border-transparent hover:border-blue-200">
                                <input type="checkbox" class="custom-checkbox mt-1" value="tuition" onchange="updateSelectedFees()">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xs font-bold text-slate-500 bg-slate-200 px-2 py-0.5 rounded font-mono">HP-HK1</span>
                                        <span class="px-2 py-0.5 bg-red-100 text-red-600 text-[9px] font-black uppercase rounded">Bắt buộc</span>
                                    </div>
                                    <h4 class="text-sm font-bold text-slate-800 mb-1">Học phí</h4>
                                    <p class="text-xs text-slate-500">2,500,000 ₫ • Học kỳ 1</p>
                                </div>
                            </label>

                            <label class="flex items-start gap-4 p-5 bg-slate-50 rounded-2xl cursor-pointer hover:bg-blue-50 transition-all border-2 border-transparent hover:border-blue-200">
                                <input type="checkbox" class="custom-checkbox mt-1" value="insurance" onchange="updateSelectedFees()">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xs font-bold text-slate-500 bg-slate-200 px-2 py-0.5 rounded font-mono">BHYT-25</span>
                                        <span class="px-2 py-0.5 bg-red-100 text-red-600 text-[9px] font-black uppercase rounded">Bắt buộc</span>
                                    </div>
                                    <h4 class="text-sm font-bold text-slate-800 mb-1">Bảo hiểm y tế</h4>
                                    <p class="text-xs text-slate-500">854,000 ₫ • Cả năm</p>
                                </div>
                            </label>

                            <label class="flex items-start gap-4 p-5 bg-slate-50 rounded-2xl cursor-pointer hover:bg-blue-50 transition-all border-2 border-transparent hover:border-blue-200">
                                <input type="checkbox" class="custom-checkbox mt-1" value="uniform" onchange="updateSelectedFees()">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xs font-bold text-slate-500 bg-slate-200 px-2 py-0.5 rounded font-mono">DP-HK1</span>
                                        <span class="px-2 py-0.5 bg-blue-100 text-blue-600 text-[9px] font-black uppercase rounded">Tự nguyện</span>
                                    </div>
                                    <h4 class="text-sm font-bold text-slate-800 mb-1">Tiền đồng phục</h4>
                                    <p class="text-xs text-slate-500">850,000 ₫ • Học kỳ 1</p>
                                </div>
                            </label>

                            <label class="flex items-start gap-4 p-5 bg-slate-50 rounded-2xl cursor-pointer hover:bg-blue-50 transition-all border-2 border-transparent hover:border-blue-200">
                                <input type="checkbox" class="custom-checkbox mt-1" value="boarding" onchange="updateSelectedFees()">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-xs font-bold text-slate-500 bg-slate-200 px-2 py-0.5 rounded font-mono">BT-HK1</span>
                                        <span class="px-2 py-0.5 bg-blue-100 text-blue-600 text-[9px] font-black uppercase rounded">Tự nguyện</span>
                                    </div>
                                    <h4 class="text-sm font-bold text-slate-800 mb-1">Tiền ăn bán trú</h4>
                                    <p class="text-xs text-slate-500">1,200,000 ₫ • Học kỳ 1</p>
                                </div>
                            </label>
                        </div>

                        <!-- Summary -->
                        <div class="mt-6 p-5 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl border border-blue-100">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-1">Tổng tiền thu
                                        dự kiến</p>
                                    <p id="totalAmount" class="text-2xl font-black text-[#0284C7]">0 ₫</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-1">Số khoản thu
                                        đã chọn</p>
                                    <p id="selectedFeesCount" class="text-2xl font-black text-slate-800">0</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 3: Cấu hình thời gian -->
                    <div id="stepContent3" class="step-content hidden">
                        <div class="mb-6">
                            <h4 class="text-base font-black text-slate-800 mb-2">Bước 3: Cấu hình thời gian áp dụng</h4>
                            <p class="text-sm text-slate-500">Thiết lập thời gian bắt đầu và hạn thanh toán</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Timeline Configuration -->
                            <div class="space-y-6">
                                <div class="p-6 bg-slate-50 rounded-2xl">
                                    <h5 class="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#22c55e"
                                            stroke-width="2">
                                            <circle cx="12" cy="12" r="10" />
                                            <polyline points="12 6 12 12 16 14" />
                                        </svg>
                                        Thời gian áp dụng
                                    </h5>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Ngày bắt đầu áp dụng</label>
                                            <input type="date" id="startDate"
                                                class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-green-100 outline-none">
                                            <p class="text-[10px] text-slate-400 mt-1">Ngày hệ thống bắt đầu tính công nợ</p>
                                        </div>
                                        <div>
                                            <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Ngày hết hạn (Due Date)</label>
                                            <input type="date" id="dueDate"
                                                class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-100 outline-none">
                                            <p class="text-[10px] text-slate-400 mt-1">Hạn thanh toán cuối cùng</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="p-6 bg-slate-50 rounded-2xl">
                                    <h5 class="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#f59e0b"
                                            stroke-width="2">
                                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" />
                                            <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                                        </svg>
                                        Cài đặt nhắc nhở
                                    </h5>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Nhắc trước hạn (ngày)</label>
                                            <select id="reminderDays"
                                                class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-bold outline-none cursor-pointer">
                                                <option value="3">3 ngày trước</option>
                                                <option value="5">5 ngày trước</option>
                                                <option value="7" selected>7 ngày trước</option>
                                                <option value="10">10 ngày trước</option>
                                                <option value="14">14 ngày trước</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Tần suất nhắc</label>
                                            <select id="reminderFrequency"
                                                class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-bold outline-none cursor-pointer">
                                                <option value="once">Nhắc 1 lần</option>
                                                <option value="daily" selected>Hàng ngày</option>
                                                <option value="weekly">Hàng tuần</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Summary Card -->
                            <div>
                                <div class="p-6 bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl text-white">
                                    <h5 class="text-sm font-bold mb-6 flex items-center gap-2">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white"
                                            stroke-width="2">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                            <polyline points="14 2 14 8 20 8" />
                                        </svg>
                                        Thông tin đợt thu
                                    </h5>
                                    <div class="space-y-4">
                                        <div class="flex justify-between items-center pb-3 border-b border-white/10">
                                            <span class="text-xs text-slate-400 uppercase tracking-wider">Tên phiếu thu</span>
                                            <span id="summaryInvoiceName" class="text-lg font-black text-blue-300">Chưa đặt tên</span>
                                        </div>
                                        <div class="flex justify-between items-center pb-3 border-b border-white/10">
                                            <span class="text-xs text-slate-400 uppercase tracking-wider">Số lớp</span>
                                            <span id="summaryClasses" class="text-lg font-black">0</span>
                                        </div>
                                        <div class="flex justify-between items-center pb-3 border-b border-white/10">
                                            <span class="text-xs text-slate-400 uppercase tracking-wider">Số học sinh</span>
                                            <span id="summaryStudents" class="text-lg font-black">0</span>
                                        </div>
                                        <div class="flex justify-between items-center pb-3 border-b border-white/10">
                                            <span class="text-xs text-slate-400 uppercase tracking-wider">Số khoản thu</span>
                                            <span id="summaryFees" class="text-lg font-black">0</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-xs text-slate-400 uppercase tracking-wider">Tổng tiền</span>
                                            <span id="summaryTotal" class="text-xl font-black text-green-400">0 ₫</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 4: Xác nhận & Phê duyệt -->
                    <div id="stepContent4" class="step-content hidden">
                        <!-- Compact Header -->
                        <div class="flex items-center justify-between mb-5">
                            <div>
                                <h4 class="text-base font-black text-slate-800">Xác nhận & Phê duyệt</h4>
                                <p class="text-xs text-slate-500 mt-0.5">Kiểm tra lại thông tin trước khi xuất phiếu thu</p>
                            </div>
                            <div class="px-4 py-2 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl border border-blue-200">
                                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-wider">Tên phiếu thu</p>
                                <p id="finalInvoiceName" class="text-sm font-black text-[#0284C7]">Chưa đặt tên</p>
                            </div>
                        </div>

                        <!-- Summary Grid - Compact -->
                        <div class="grid grid-cols-4 gap-3 mb-5">
                            <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white text-center">
                                <svg class="mx-auto mb-2" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="9" cy="7" r="4"/>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                </svg>
                                <p class="text-[10px] font-bold text-blue-100 uppercase tracking-wider">Số lớp</p>
                                <p id="summaryClassesFinal" class="text-xl font-black">0</p>
                            </div>
                            <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white text-center">
                                <svg class="mx-auto mb-2" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="9" cy="7" r="4"/>
                                </svg>
                                <p class="text-[10px] font-bold text-purple-100 uppercase tracking-wider">Học sinh</p>
                                <p id="summaryStudentsFinal" class="text-xl font-black">0</p>
                            </div>
                            <div class="bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl p-4 text-white text-center">
                                <svg class="mx-auto mb-2" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="5" width="20" height="14" rx="2"/>
                                    <line x1="2" y1="10" x2="22" y2="10"/>
                                </svg>
                                <p class="text-[10px] font-bold text-amber-100 uppercase tracking-wider">Khoản thu</p>
                                <p id="summaryFeesFinal" class="text-xl font-black">0</p>
                            </div>
                            <div class="bg-gradient-to-br from-emerald-500 to-green-500 rounded-xl p-4 text-white text-center">
                                <svg class="mx-auto mb-2" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="1" x2="12" y2="23"/>
                                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                                </svg>
                                <p class="text-[10px] font-bold text-emerald-100 uppercase tracking-wider">Tổng tiền</p>
                                <p id="summaryTotalFinal" class="text-sm font-black">0 ₫</p>
                            </div>
                        </div>

                        <!-- Details Grid - Compact -->
                        <div class="grid grid-cols-2 gap-4 mb-5">
                            <div class="bg-slate-50 rounded-xl p-4">
                                <h5 class="text-xs font-black text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#0284C7" stroke-width="2.5">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                    </svg>
                                    Đối tượng áp dụng
                                </h5>
                                <div id="finalReviewClasses" class="flex flex-wrap gap-2 max-h-[100px] overflow-y-auto">
                                    <!-- Filled dynamically -->
                                </div>
                            </div>
                            <div class="bg-slate-50 rounded-xl p-4">
                                <h5 class="text-xs font-black text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#0284C7" stroke-width="2.5">
                                        <rect x="2" y="5" width="20" height="14" rx="2"/>
                                        <line x1="2" y1="10" x2="22" y2="10"/>
                                    </svg>
                                    Khoản thu
                                </h5>
                                <div id="finalReviewFees" class="space-y-2 max-h-[100px] overflow-y-auto">
                                    <!-- Filled dynamically -->
                                </div>
                            </div>
                        </div>

                        <!-- Confirm & Actions -->
                        <div class="flex items-center gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl border border-slate-200">
                            <label class="flex items-start gap-3 flex-1 cursor-pointer">
                                <input type="checkbox" id="confirmTerms" class="custom-checkbox mt-0.5">
                                <span class="text-xs text-slate-600 font-medium leading-relaxed">
                                    Tôi xác nhận đã kiểm tra kỹ thông tin và chịu trách nhiệm về độ chính xác của dữ liệu.
                                </span>
                            </label>
                            <div class="flex items-center gap-2">
                                <button onclick="previousStep()"
                                    class="px-5 py-2.5 bg-white border border-slate-200 rounded-xl font-bold text-xs text-slate-700 hover:bg-slate-50 flex items-center gap-1.5">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                        <polyline points="15 18 9 12 15 6"></polyline>
                                    </svg>
                                    Quay lại
                                </button>
                                <button onclick="generateInvoices()"
                                    class="px-6 py-2.5 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl font-bold text-xs hover:from-green-600 hover:to-emerald-600 flex items-center gap-1.5 shadow-lg shadow-green-100">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                    Phê duyệt & Xuất phiếu
                                </button>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Navigation Buttons (Steps 1-3) -->
                <div id="stepNavigation" class="px-8 pb-8 flex items-center justify-between">
                    <button onclick="previousStep()" id="prevBtn"
                        class="px-6 py-3 bg-white border border-slate-200 rounded-xl font-bold text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-2 hidden">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                        Quay lại
                    </button>
                    <div class="flex-1"></div>
                    <button onclick="nextStep()" id="nextBtn"
                        class="px-6 py-3 bg-[#0284C7] text-white rounded-xl font-bold text-sm hover:bg-[#0369a1] flex items-center gap-2">
                        Tiếp theo
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </button>
                </div>
            </section>

        </div>
    </main>

    <!-- ADD FEE MODAL -->
    <div id="addFeeModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-overlay absolute inset-0" onclick="closeAddFeeModal()"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-3xl shadow-2xl w-full max-w-lg animate-slide-in">
            <div class="p-8 border-b border-slate-100">
                <h3 class="text-xl font-black text-slate-800">Thêm khoản thu mới</h3>
                <p class="text-sm text-slate-500 mt-1">Tạo loại khoản thu cho năm học 2025-2026</p>
            </div>
            <div class="p-8 space-y-5">
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Tên khoản thu</label>
                    <input type="text" id="newFeeName" placeholder="Ví dụ: Học phí, Tiền ăn..."
                        class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-100 outline-none">
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Mã khoản thu</label>
                    <input type="text" id="newFeeCode" placeholder="Ví dụ: HP-HK1, BHYT-25, DP-HK1..."
                        class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold font-mono focus:ring-2 focus:ring-blue-100 outline-none">
                    <p class="text-[10px] text-slate-400 mt-1">Mã định danh cho khoản thu (tối đa 20 ký tự)</p>
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Loại</label>
                    <select id="newFeeType"
                        class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold outline-none cursor-pointer">
                        <option value="mandatory">Bắt buộc</option>
                        <option value="voluntary">Tự nguyện</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Số tiền định
                        mức (VNĐ)</label>
                    <input type="number" id="newFeeAmount" placeholder="0"
                        class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-blue-100 outline-none">
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block">Học kỳ</label>
                    <select id="newFeeSemester"
                        class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold outline-none cursor-pointer">
                        <option value="1">Học kỳ 1</option>
                        <option value="2">Học kỳ 2</option>
                        <option value="all">Cả năm</option>
                    </select>
                </div>
            </div>
            <div class="p-8 border-t border-slate-100 flex items-center justify-end gap-3">
                <button onclick="closeAddFeeModal()"
                    class="px-6 py-2.5 bg-white border border-slate-200 rounded-xl font-bold text-sm text-slate-700 hover:bg-slate-50">
                    Hủy
                </button>
                <button onclick="saveNewFee()"
                    class="px-6 py-2.5 bg-[#0284C7] text-white rounded-xl font-bold text-sm hover:bg-[#0369a1]">
                    Lưu khoản thu
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast"
        class="fixed bottom-8 right-8 bg-slate-900 text-white px-8 py-4 rounded-2xl shadow-2xl transition-all transform translate-y-20 opacity-0 font-bold z-50">
        Thông báo hệ thống
    </div>

    <script>
        // State Management
        let currentStep = 1;
        let selectedClasses = [];
        let selectedFees = [];
        let invoiceName = '';
        let feeItemsData = [
            { id: 'tuition', name: 'Học phí', code: 'HP-HK1', type: 'mandatory', amount: 2500000, semester: 'Học kỳ 1' },
            { id: 'insurance', name: 'Bảo hiểm y tế', code: 'BHYT-25', type: 'mandatory', amount: 854000, semester: 'Cả năm' },
            { id: 'uniform', name: 'Tiền đồng phục', code: 'DP-HK1', type: 'voluntary', amount: 850000, semester: 'Học kỳ 1' },
            { id: 'boarding', name: 'Tiền ăn bán trú', code: 'BT-HK1', type: 'voluntary', amount: 1200000, semester: 'Học kỳ 1' }
        ];

        // Grade data
        const gradeData = {
            '6': { classes: ['6A', '6B', '6C', '6D', '6E', '6F'], students: 180 },
            '7': { classes: ['7A', '7B', '7C', '7D', '7E', '7F'], students: 195 },
            '8': { classes: ['8A', '8B', '8C', '8D', '8E', '8F'], students: 188 },
            '9': { classes: ['9A', '9B', '9C', '9D', '9E', '9F'], students: 175 }
        };

        // Invoice Name
        function updateInvoiceName() {
            invoiceName = document.getElementById('invoiceName').value.trim();
        }

        // Step Navigation
        function nextStep() {
            if (currentStep < 4) {
                // Validate step before proceeding
                if (currentStep === 1 && selectedClasses.length === 0) {
                    showToast('Vui lòng chọn ít nhất một lớp!');
                    return;
                }
                if (currentStep === 2) {
                    if (!document.getElementById('invoiceName').value.trim()) {
                        showToast('Vui lòng nhập tên phiếu thu!');
                        return;
                    }
                    if (selectedFees.length === 0) {
                        showToast('Vui lòng chọn ít nhất một khoản thu!');
                        return;
                    }
                }

                currentStep++;
                updateStepUI();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepUI();
            }
        }

        function updateStepUI() {
            // Update step indicators
            for (let i = 1; i <= 4; i++) {
                const stepItem = document.getElementById(`step${i}`);
                const stepContent = document.getElementById(`stepContent${i}`);

                if (i < currentStep) {
                    stepItem.classList.add('completed');
                    stepItem.classList.remove('active');
                } else if (i === currentStep) {
                    stepItem.classList.add('active');
                    stepItem.classList.remove('completed');
                } else {
                    stepItem.classList.remove('active', 'completed');
                }

                // Show/hide content
                if (i === currentStep) {
                    stepContent.classList.remove('hidden');
                    stepContent.classList.add('animate-slide-in');
                } else {
                    stepContent.classList.add('hidden');
                }
            }

            // Update navigation buttons
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const stepNavigation = document.getElementById('stepNavigation');

            if (currentStep === 1) {
                prevBtn.classList.add('hidden');
            } else {
                prevBtn.classList.remove('hidden');
            }

            if (currentStep === 4) {
                stepNavigation.classList.add('hidden');
                updateFinalReview();
            } else {
                stepNavigation.classList.remove('hidden');
                nextBtn.innerHTML = currentStep === 3 ? 'Xem trước <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg>' : 'Tiếp theo <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg>';
            }

            // Update summary on step 3
            if (currentStep === 3) {
                updateSummaryCard();
            }
        }

        // Grade/Class Selection
        function toggleGrade(grade) {
            const checkbox = event.target;
            const classes = gradeData[grade].classes;

            if (checkbox.checked) {
                classes.forEach(cls => {
                    if (!selectedClasses.includes(cls)) {
                        selectedClasses.push(cls);
                    }
                });
            } else {
                classes.forEach(cls => {
                    const index = selectedClasses.indexOf(cls);
                    if (index > -1) {
                        selectedClasses.splice(index, 1);
                    }
                });
            }

            updateSelectedClassesDisplay();
        }

        function updateSelectedClassesDisplay() {
            const container = document.getElementById('selectedClassesDisplay');

            if (selectedClasses.length === 0) {
                container.innerHTML = '<p class="text-sm text-slate-400 text-center py-8">Chưa chọn lớp nào</p>';
                return;
            }

            let html = '';
            selectedClasses.forEach(cls => {
                html += `
                    <div class="multi-select-tag">
                        <span class="font-black">${cls}</span>
                        <button onclick="removeClass('${cls}')">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function removeClass(cls) {
            const index = selectedClasses.indexOf(cls);
            if (index > -1) {
                selectedClasses.splice(index, 1);
            }
            updateSelectedClassesDisplay();
        }

        // Fee Selection
        function updateSelectedFees() {
            const checkboxes = document.querySelectorAll('#feeItemsGrid input[type="checkbox"]');
            selectedFees = [];

            checkboxes.forEach(cb => {
                if (cb.checked) {
                    const feeData = feeItemsData.find(f => f.id === cb.value);
                    if (feeData) {
                        selectedFees.push(feeData);
                    }
                }
            });

            // Update total amount display
            const total = selectedFees.reduce((sum, fee) => sum + fee.amount, 0);
            document.getElementById('totalAmount').textContent = formatCurrency(total);
            document.getElementById('selectedFeesCount').textContent = selectedFees.length;
        }

        // Summary Card
        function updateSummaryCard() {
            const totalStudents = selectedClasses.length * 40; // Estimate 40 students per class
            const totalPerStudent = selectedFees.reduce((sum, fee) => sum + fee.amount, 0);
            const totalAmount = totalPerStudent * totalStudents;

            document.getElementById('summaryInvoiceName').textContent = invoiceName || 'Chưa đặt tên';
            document.getElementById('summaryClasses').textContent = selectedClasses.length;
            document.getElementById('summaryStudents').textContent = totalStudents;
            document.getElementById('summaryFees').textContent = selectedFees.length;
            document.getElementById('summaryTotal').textContent = formatCurrency(totalAmount);
        }

        // Final Review
        function updateFinalReview() {
            const totalStudents = selectedClasses.length * 40; // Estimate 40 students per class
            const totalPerStudent = selectedFees.reduce((sum, fee) => sum + fee.amount, 0);
            const totalAmount = totalPerStudent * totalStudents;

            // Invoice name
            document.getElementById('finalInvoiceName').textContent = invoiceName || 'Chưa đặt tên';

            // Summary cards
            document.getElementById('summaryClassesFinal').textContent = selectedClasses.length;
            document.getElementById('summaryStudentsFinal').textContent = totalStudents;
            document.getElementById('summaryFeesFinal').textContent = selectedFees.length;
            document.getElementById('summaryTotalFinal').textContent = formatCurrency(totalAmount);

            // Classes review - tags style
            const classesContainer = document.getElementById('finalReviewClasses');
            let classesHtml = '';
            selectedClasses.forEach(cls => {
                classesHtml += `<span class="inline-flex items-center px-2.5 py-1 bg-blue-100 text-blue-700 text-[10px] font-black rounded-lg">${cls}</span>`;
            });
            classesContainer.innerHTML = classesHtml || '<p class="text-xs text-slate-400 italic">Chưa chọn lớp</p>';

            // Fees review - compact list
            const feesContainer = document.getElementById('finalReviewFees');
            let feesHtml = '';
            selectedFees.forEach(fee => {
                feesHtml += `
                    <div class="flex items-center justify-between text-xs py-1.5 px-2 bg-white rounded-lg border border-slate-100">
                        <span class="font-bold text-slate-700">${fee.name}</span>
                        <span class="font-black text-[#0284C7]">${formatCurrency(fee.amount)}</span>
                    </div>
                `;
            });
            feesContainer.innerHTML = feesHtml || '<p class="text-xs text-slate-400 italic">Chưa chọn khoản thu</p>';
        }

        // Generate Invoices
        function generateInvoices() {
            const confirmTerms = document.getElementById('confirmTerms');
            if (!confirmTerms.checked) {
                showToast('Vui lòng xác nhận điều khoản!');
                return;
            }

            // Simulate generating invoices
            showToast('Đang tạo phiếu thu...');
            setTimeout(() => {
                showToast('Đã tạo thành công ' + (selectedClasses.length * 40) + ' phiếu thu!');
                // Reset and go back to step 1
                currentStep = 1;
                selectedClasses = [];
                selectedFees = [];
                invoiceName = '';
                updateStepUI();
                updateSelectedClassesDisplay();

                // Uncheck all checkboxes
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                document.getElementById('totalAmount').textContent = '0 ₫';
                document.getElementById('selectedFeesCount').textContent = '0';
                document.getElementById('invoiceName').value = '';
            }, 2000);
        }

        // Modal Functions
        function openAddFeeModal() {
            document.getElementById('addFeeModal').classList.remove('hidden');
        }

        function closeAddFeeModal() {
            document.getElementById('addFeeModal').classList.add('hidden');
        }

        function saveNewFee() {
            const name = document.getElementById('newFeeName').value;
            const type = document.getElementById('newFeeType').value;
            const amount = parseInt(document.getElementById('newFeeAmount').value);
            const semester = document.getElementById('newFeeSemester').value;

            if (!name || !amount) {
                showToast('Vui lòng nhập đầy đủ thông tin!');
                return;
            }

            // Add to table (simplified demo)
            showToast('Đã thêm khoản thu: ' + name);
            closeAddFeeModal();

            // Reset form
            document.getElementById('newFeeName').value = '';
            document.getElementById('newFeeAmount').value = '';
        }

        function deleteFeeItem(btn) {
            if (confirm('Bạn có chắc muốn xóa khoản thu này?')) {
                const row = btn.closest('tr');
                row.style.opacity = '0';
                setTimeout(() => row.remove(), 300);
                showToast('Đã xóa khoản thu!');
            }
        }

        function filterFeeItems() {
            const year = document.getElementById('filterYear').value;
            const semester = document.getElementById('filterSemester').value;
            showToast(`Lọc: ${year} - ${semester === 'all' ? 'Tất cả' : 'Học kỳ ' + semester}`);
        }

        // Utility Functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(amount);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function () {
            // Set default start date to today
            const startDateInput = document.getElementById('startDate');
            const today = new Date();
            startDateInput.value = today.toISOString().split('T')[0];

            // Set default due date to 30 days from now
            const dueDateInput = document.getElementById('dueDate');
            const defaultDate = new Date();
            defaultDate.setDate(defaultDate.getDate() + 30);
            dueDateInput.value = defaultDate.toISOString().split('T')[0];
        });
    </script>

</body>
</html>
